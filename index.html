---
---
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ site.title }}</title>
  <style>
    body { font-family: system-ui, -apple-system, sans-serif; max-width: 1200px; margin: 0 auto; padding: 2rem; }
    h1 { margin-bottom: 2rem; }
    .section { margin-bottom: 2rem; }
    .label { font-weight: 600; display: block; margin-bottom: 0.5rem; font-size: 0.9rem; text-transform: uppercase; color: #666; }
    .items { display: flex; flex-wrap: wrap; gap: 0.5rem; }
    .item { background: #f5f5f5; padding: 0.75rem 1rem; border-radius: 4px; cursor: pointer; font-size: 0.95rem; transition: background 0.2s; }
    .item:hover { background: #e8e8e8; }
    .count { font-size: 0.8rem; color: #999; margin-left: 0.5rem; }
    #gallery { display: none; }
    .gallery-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem; }
    .back { cursor: pointer; color: #0066cc; font-size: 1.1rem; }
    .back:hover { text-decoration: underline; }
    .gallery-images { display: flex; flex-wrap: wrap; gap: 1rem; }
    .gallery-images img { max-width: 200px; height: auto; border-radius: 4px; }
  </style>
</head>
<body>
  <h1>{{ site.full_name }}</h1>

  <div class="section">
    <span class="label">Albums</span>
    <div class="items" id="albums"></div>
  </div>

  <div class="section">
    <span class="label">Categories</span>
    <div class="items" id="categories"></div>
  </div>

  <div id="gallery">
    <div class="gallery-header">
      <span class="back" onclick="closeGallery()">‚Üê Back</span>
      <h2 id="gallery-title" style="margin: 0;"></h2>
    </div>
    <div class="gallery-images" id="gallery-images"></div>
  </div>

  <script>
    var files = [
      {% for file in site.static_files %}
        {% assign p = file.path %}
        {% if p contains 'images/' and (p contains '.jpg' or p contains '.jpeg' or p contains '.png' or p contains '.gif' or p contains '.webp') %}
          "{{ file.path | relative_url }}",
        {% endif %}
      {% endfor %}
    ];

    var albumsMap = {};
    var categoriesMap = {};

    files.forEach(function(path){
      var parts = path.replace(/^\/+,'').split('/');
      if(parts.length < 3) return;

      var album = parts[1];
      albumsMap[album] = albumsMap[album] || [];
      albumsMap[album].push(path);

      var filename = parts[parts.length - 1];
      var base = filename.replace(/\.[^/.]+$/, '');
      var first = base.split(/[^A-Za-z0-9]+/)[0] || base;
      var key = first.toLowerCase();
      var display = first.charAt(0).toUpperCase() + first.slice(1);
      categoriesMap[key] = categoriesMap[key] || { display: display, items: [] };
      categoriesMap[key].items.push(path);
    });

    function render(){
      var albumsEl = document.getElementById('albums');
      var categoriesEl = document.getElementById('categories');

      albumsEl.innerHTML = '';
      Object.keys(albumsMap).sort().forEach(function(album){
        var item = document.createElement('div');
        item.className = 'item';
        item.innerHTML = album + '<span class="count">(' + albumsMap[album].length + ')</span>';
        item.onclick = function(){ showGallery(album, albumsMap[album], 'Album: ' + album); };
        albumsEl.appendChild(item);
      });

      categoriesEl.innerHTML = '';
      Object.keys(categoriesMap).sort().forEach(function(key){
        var c = categoriesMap[key];
        var item = document.createElement('div');
        item.className = 'item';
        item.innerHTML = c.display + '<span class="count">(' + c.items.length + ')</span>';
        item.onclick = function(){ showGallery(c.display, c.items, 'Category: ' + c.display); };
        categoriesEl.appendChild(item);
      });
    }

    function showGallery(name, items, title){
      document.getElementById('albums').parentElement.style.display = 'none';
      document.getElementById('categories').parentElement.style.display = 'none';
      document.getElementById('gallery').style.display = 'block';
      document.getElementById('gallery-title').textContent = title;
      
      var container = document.getElementById('gallery-images');
      container.innerHTML = '';
      items.forEach(function(src){
        var img = document.createElement('img');
        img.src = src;
        img.alt = name;
        container.appendChild(img);
      });
      window.scrollTo(0, 0);
    }

    function closeGallery(){
      document.getElementById('albums').parentElement.style.display = 'block';
      document.getElementById('categories').parentElement.style.display = 'block';
      document.getElementById('gallery').style.display = 'none';
    }

    render();
  </script>
</body>
</html>